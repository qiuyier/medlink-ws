# ============================================
# MedLink WebSocket 服务环境变量配置
# ============================================

# -------------------- 项目配置 --------------------
COMPOSE_PROJECT_NAME=medlink
PROJECT_NAME=medlink-ws
ENVIRONMENT=development  # development, staging, production

# -------------------- 服务端口 --------------------
HTTP_PORT=8080
WS_PORT=8081

# -------------------- PostgreSQL --------------------
POSTGRES_VERSION=15-alpine
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_DB=medical_ws
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres123
POSTGRES_SSLMODE=disable
POSTGRES_MAX_CONNECTIONS=100

# PostgreSQL 连接池配置
POSTGRES_MAX_OPEN_CONNS=25
POSTGRES_MAX_IDLE_CONNS=5
POSTGRES_CONN_MAX_LIFETIME=1h
POSTGRES_CONN_MAX_IDLE_TIME=30m

# -------------------- Redis --------------------
REDIS_VERSION=7-alpine
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=redis123
REDIS_DB=0
REDIS_MAX_MEMORY=512mb
REDIS_MAX_MEMORY_POLICY=allkeys-lru

# -------------------- RabbitMQ --------------------
RABBITMQ_VERSION=3.12-management-alpine
RABBITMQ_HOST=rabbitmq
RABBITMQ_PORT=5672
RABBITMQ_MANAGEMENT_PORT=15672
RABBITMQ_DEFAULT_USER=admin
RABBITMQ_DEFAULT_PASS=rabbitmq123
RABBITMQ_DEFAULT_VHOST=/
RABBITMQ_VM_MEMORY=512MB
RABBITMQ_DISK_FREE_LIMIT=2GB

# RabbitMQ 业务配置
RABBITMQ_EXCHANGE=ws.messages
RABBITMQ_QUEUE=ws.queue

# -------------------- Kafka & Zookeeper --------------------
KAFKA_VERSION=7.5.0
ZOOKEEPER_VERSION=7.5.0

ZOOKEEPER_HOST=zookeeper
ZOOKEEPER_PORT=2181
ZOOKEEPER_CLIENT_PORT=2181
ZOOKEEPER_TICK_TIME=2000

KAFKA_HOST=kafka
KAFKA_PORT=9092
KAFKA_EXTERNAL_PORT=29092
KAFKA_BROKER_ID=1
KAFKA_OFFSETS_TOPIC_REPLICATION_FACTOR=1
KAFKA_TRANSACTION_STATE_LOG_REPLICATION_FACTOR=1
KAFKA_TRANSACTION_STATE_LOG_MIN_ISR=1
KAFKA_LOG_RETENTION_HOURS=168  # 7天
KAFKA_AUTO_CREATE_TOPICS=true

# Kafka 业务配置
KAFKA_TOPIC=ws-messages
KAFKA_GROUP_ID=ws-server-group
KAFKA_PARTITIONS=3

# -------------------- JWT 认证 --------------------
JWT_SECRET=your-super-secret-jwt-key-change-in-production-min-32-chars
JWT_EXPIRE_TIME=24h

# -------------------- WebSocket 配置 --------------------
WS_READ_BUFFER_SIZE=1024
WS_WRITE_BUFFER_SIZE=1024
WS_HANDSHAKE_TIMEOUT=10s
WS_PING_INTERVAL=30s
WS_PONG_TIMEOUT=90s
WS_MAX_MESSAGE_SIZE=1048576  # 1MB
WS_SEND_CHANNEL_SIZE=256
WS_MAX_CONN_PER_USER=5

# -------------------- 管理工具端口 --------------------
KAFKA_UI_PORT=8090
REDIS_COMMANDER_PORT=8081
PGADMIN_PORT=8082
PGADMIN_EMAIL=admin@medlink.com
PGADMIN_PASSWORD=admin123

# -------------------- 监控配置 --------------------
PROMETHEUS_PORT=9090
GRAFANA_PORT=3000
GRAFANA_USER=admin
GRAFANA_PASSWORD=admin123

# -------------------- 日志配置 --------------------
LOG_LEVEL=debug  # debug, info, warn, error
LOG_FORMAT=json  # json, console

# -------------------- 时区 --------------------
TZ=Asia/Shanghai

# -------------------- 平台架构 --------------------
PLATFORM=linux/arm64  # M1 芯片